# =============================================================================
# LTMBSE ACE Algorithm - Environment Configuration
# See docs/SETUP.md for detailed setup instructions and how to obtain each key.
# =============================================================================

# --- LLM Backend Selection ---
# Which backend to use for the main LLM: "gemini" or "openai"
LLM_BACKEND=gemini

# --- Google Gemini (Required) ---
# Used for ACE Reflector (lesson extraction from execution traces)
# Get your key at: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your-gemini-api-key
GEMINI_MODEL=gemini-3-flash-preview

# --- OpenAI (Required for CL-bench benchmarking) ---
# Used for GPT-5.1 solver and evaluation judge
# Get your key at: https://platform.openai.com/api-keys
OPENAI_API_KEY=your-openai-api-key
OPENAI_MODEL=gpt-5.1
# Admin key for organization usage/cost reconciliation (required in strict dual-source mode)
OPENAI_ADMIN_API_KEY=
# OpenAI project id used to scope billed-cost reconciliation queries
OPENAI_COST_PROJECT_ID=
# Optional: custom base URL for OpenAI-compatible APIs (HuggingFace, vLLM, Ollama)
# OPENAI_API_BASE=https://your-endpoint.endpoints.huggingface.cloud/v1

# --- Neo4j Database (Required) ---
# Stores ACE memory bullets persistently
# Create a free instance at: https://console.neo4j.io/?product=aura-db
NEO4J_URI=neo4j+s://xxxxx.databases.neo4j.io
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=your-password
# Optional: database name for multi-database Neo4j setups (leave unset for default)
# NEO4J_DATABASE=

# --- ACE Algorithm Tuning ---
ACE_LLM_TEMPERATURE=0.2
ACE_CURATOR_SIMILARITY=0.9
ACE_CURATOR_SUPPORT_SIMILARITY=0.95
ACE_CURATOR_USE_LLM=false
ACE_MEMORY_BASE_STRENGTH=100.0
ACE_MEMORY_SIMILARITY_MERGE=0.9

# --- ACE CL-bench Enhancements ---
# Bullet injection: "post_context" (after context, before task) or "pre_context" (original)
ACE_INJECTION_MODE=post_context
# Retrieval scoring weights (max-quality defaults)
ACE_WEIGHT_RELEVANCE=0.60
ACE_WEIGHT_STRENGTH=0.20
ACE_WEIGHT_TYPE=0.20
# Pre-seed meta-strategy bullets for new contexts
ACE_SEED_META_STRATEGIES=true
# Retrieval balancing for learned memory visibility
ACE_MIN_LEARNED_BULLETS=2
ACE_SEED_BULLET_PENALTY=0.25
ACE_LEARNED_BULLET_BONUS=0.08
# Global memory defaults
ACE_SEED_GLOBAL_META_STRATEGIES=false
# Quality gate defaults (max-quality profile)
ACE_QG_GATE_SCORE_MIN=0.60
ACE_QG_LESSON_SCORE_MIN=0.55
ACE_QG_OVERLAP_MIN=0.05
ACE_QG_CONFIDENCE_MIN=0.70
ACE_QG_MAX_ACCEPTED_LESSONS=4

# --- ACE V4/V5 Memory + Process Scoring ---
ACE_MEMORY_SCOPE_MODE=hybrid
ACE_GLOBAL_GATE_SCORE_MIN=0.80
ACE_LOCAL_TOP_K=8
ACE_GLOBAL_TOP_K=5
ACE_CONTEXT_WORKERS=6
ACE_STEP_SCORING_MODE=full
ACE_STEP_SCORER_MODEL=gpt-5.1
ACE_STEP_SCORE_WORKERS=12
ACE_STEP_SCORE_MIN=0.40
ACE_MAX_COMPLETION_TOKENS=16384
ACE_EMPTY_OUTPUT_RETRY_MAX_TOKENS=32768

# --- ACE Planner and Recursive Reasoning (V5) ---
ACE_PLANNER_POLICY=bandit
ACE_PLANNER_EPSILON=0.08
ACE_PLANNER_UCB_C=1.10
ACE_PLANNER_SEED=42
ACE_RECURSION_MAX_ROUNDS=2
ACE_RECURSION_CANDIDATES=3
ACE_RECURSION_IMPROVE_MIN=0.03
# Optional planner state overrides
# ACE_PLANNER_STATE_PATH=benchmark/results/v5/planner_policy_runtime_v5.json
# ACE_PLANNER_STATE_PATH_BASELINE=benchmark/results/v5/planner_policy_baseline_v5.json
# ACE_PLANNER_STATE_PATH_ACE=benchmark/results/v5/planner_policy_ace_v5.json

# --- ACE V5 Reliability / Durability ---
ACE_NEO4J_RETRY_MAX=2
ACE_NEO4J_RETRY_BACKOFF_SEC=1.0
ACE_NEO4J_RECONNECT_ON_SESSION_EXPIRED=true
ACE_V5_RESUME_FROM_PROGRESS=true
ACE_V5_FINALIZE_ORDER=true
# Optional override for durable journal path used by infer_ace_direct_v5.py
# ACE_V5_PROGRESS_PATH=benchmark/results/v5/ace_v5.jsonl.progress.jsonl

# --- Benchmark Cost Reporting (V5) ---
BENCHMARK_COST_MODE=dual_source
BENCHMARK_BILLING_POLICY=strict

# --- Optional: Google Custom Search ---
# Enables the google_search tool in ReAct mode
# Setup: https://programmablesearchengine.google.com/controlpanel/create
# GOOGLE_CSE_ID=your-cse-id

# --- Optional: Tavily Search ---
# Enables the deep_research tool in ReAct mode
# Get your key at: https://app.tavily.com (1,000 free credits/month)
# TAVILY_API_KEY=your-tavily-key

# --- Analysis/Debugging ---
# Default learner ID for analyze_memory.py when --learner is not specified
# ACE_ANALYZE_LEARNER_ID=default_user
